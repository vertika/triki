<!DOCTYPE html>
<html lang="en">
	<head>
		<title> Triki </title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta  name="viewport" content="width=device-width,initial-scale=1.0">


		<!-- JQuery -->
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js"></script>
		<!--<script src="http://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>-->

		<!-- Bootstrap -->
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<script src="js/bootstrap.js"></script>

		<!-- Triki -->
		<link rel="stylesheet" type="text/css" href="css/trikiStyles.css" media="screen"/>
		<link type="text/css" rel="stylesheet" href="css/Category.css"/>
		<script src="js/Category.js"></script>

		<!-- JQuery UI -->
		<!-- <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
		<link rel="stylesheet" href="http://jqueryui.com/resources/demos/style.css"> -->
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js"></script>

		<script>
			var occupiedBins = 0;
			var chosenCats = ['none', 'none','none','none','none','none'];
			var cats = ['Agriculture', 'Arts', 'Business', 'Chronology', 'Culture','Education', 'Environment', 'Geography', 'Health', 'History', 'Humanities', 'Humans', 'Language', 'Law', 'Life', 'Mathematics', 'Medicine', 'Nature', 'People', 'Politics', 'Science', 'Society', 'Sports', 'Technology', 'Musicians', 'Television', 'Movies', 'Psychology', 'Fashion', 'Countries', 'Animals', 'Astrology','Food']; 

			var myBin = $('#binBox').sortable({
			    containment: 'window',
			    helper: "clone",
			    revert: 100,
			    tolerance: "pointer",
			    update: function(ev, ui) {
			    	console.log("update");
			        ui.item.addClass("correct").css({
			            "left": "0px",
			            "position": "static",
			            "top": "0px"
			        });
			    }
			}).disableSelection();

			var setTileDraggable = function(tileSelector) {
			    tileSelector.draggable( {
			      connectToSortable: myBin,
			      containment: 'window',
			      stack: '.cats div',
			      helper: "original",
			      cursor: 'move',
			      //revert: true
			      revert: "invalid"
			    }).disableSelection();
			};

			$( init );
			function init() 
			{	
				// reset
				occupiedBins = 0;
				$('.cats').html( '' );

				// CREATE CATEGORIES
				for ( var i=0; i<33; i++ ) 
				{
					$('.cats').append('<div class="well ui-draggable aCat" id="cat'+ i +'">Category' + i + '</div>');
					 
					var thisCat = $('#cat'+ i);

					thisCat.data('category',i);
					setTileDraggable(thisCat);
				}	
			}

			var myCatBox = $('#categoryBox').droppable({
				accept: '.aCat', //is this right?
				drop: function(ev,ui){
					console.log(ui.draggable);
					if(ui.draggable.hasClass("correct"))
					{
						console.log('here');
						var cloneTile = ui.draggable.clone().removeClass("correct").show();
						 // children isn't a div
						myCatBox.children('div').append(cloneTile);
						var dropx = ui.offset.left - myCatBox.offset().left;
	            		var dropy = ui.offset.top - myCatBox.offset().top;
	            		cloneTile.css({
			                "left": dropx + "px",
			                "position": "absolute",
			                "top": dropy + "px"
	           			 });
	            		console.log(cloneTile);
			            setTileDraggable(cloneTile);
			            ui.helper.remove();
			            ui.draggable.remove();
			        }
				}
			}).disableSelection();

			//setTileDraggable(myCatBox.children(".cats").find(".aCat"));
				
		</script>


	</head>

	<body style="cursor: default;">
		<div class="container" align="center">
			<a href="Home.html"><img src="trikiIcon.jpg"
			title="trikiIcon" height="30%" width="30%"></a>
		</div>

		<div class="navbar">
			<div class="navbar-inner">
				<div class="container">
					<ul class="nav">
						<li><a href="Home.php">Home</a></li>
						<li><a href="About.html">About</a></li>
						<li><a href="Rules.html">Rules</a></li>
						<li><a href="Challenges.html">Challenges</a></li>
						<li class="active"><a href="Category.html">Play!</a></li>
					</ul>
				</div>
			</div>
		</div>
		<p></p>

		<h1 align="center" style="height:50px"> Choose Your Categories </h1>
		

		<table align="center" id="bigTable">
			<tr>
				<td>
						<div class="well" id="categoryBox">
							<div class="cats"></div>
						</div>
				</td>
						
				<td>
					<div class="well" id="binBox"></div>
					
					<div style="height: 300px">
						<button class="btn .btn-large btn-success" id="playButton" align="center">Start game!
						</button>
					</div>
				</td>



			</tr>
		</table>


	  	<script>
	  		$('#playButton').click(function(){
	  				if(occupiedBins != 6)
	  				{
	  					alert("Must choose 6 categories before starting game.");
	  				}
	  				else
	  				{	
	  
	  					// categories contained in array chosenCats (from chosenCats[0] to chosenCats[5])

	  					window.location.href ='Game.html?Category1=' + chosenCats[0] +
	  					'&Category2=' + chosenCats[1] + 
	  					'&Category3=' + chosenCats[2] + 
	  		
	  					'&Category4=' + chosenCats[3] +
	  				
	  					'&Category5=' + chosenCats[4] +
	  					
	  					'&Category6=' + chosenCats[5]
	  					;
	  				}
					/*
					The categories in the link are called query strings.
					The hardcoded strings should be replaced by user selections but in the
					same format as shown.
					*/

					/*
					Also something to keep in mind: putting %20 anywhere there is a space.
					May have to write a separate function for this.
					*/

	    		
	      });
	    </script>





	</body>

</html>
